<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="HighWay"><meta name="copyright" content="HighWay"><meta name="generator" content="Hexo 5.2.0"><meta name="theme" content="hexo-theme-yun"><title>操作系统启动 | 小莫神的blog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.21/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js"></script><script>document.addEventListener("DOMContentLoaded", function() {
  renderMathInElement(document.body, {
    delimiters: [
      {left: "$$", right: "$$", display: true},
      {left: "$", right: "$", display: false},
      {left: "\\(", right: "\\)", display: false},
      {left: "\\[", right: "\\]", display: true}
    ]
  });
});</script><link rel="shortcut icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"iljava.gitee.io","root":"/","title":["小莫","神","的","blog"],"version":"1.2.0","mode":"auto","copycode":true,"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"/data/sentences.json"},"fireworks":{"colors":["143,196,233","128,149,207","220,190,236"]}};
  </script><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=UA-121354150-1"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-121354150-1');
}</script><script data-ad-client="ca-pub-2245427233262012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><meta name="description" content="操作系统启动什么是操作系统操作系统是计算机硬件和应用之间的一层软件 。">
<meta property="og:type" content="article">
<meta property="og:title" content="操作系统启动">
<meta property="og:url" content="https://iljava.gitee.io/2020/10/08/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8/index.html">
<meta property="og:site_name" content="小莫神的blog">
<meta property="og:description" content="操作系统启动什么是操作系统操作系统是计算机硬件和应用之间的一层软件 。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2020/10/08/2X14LC7juO6BPyZ.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/gHzMUOjb9Tu1t8l.jpg">
<meta property="og:image" content="https://i.loli.net/2020/10/08/QlkMGhBSKTizjoq.jpg">
<meta property="og:image" content="https://i.loli.net/2020/10/08/xsHfgd8cnYv3E5Z.jpg">
<meta property="og:image" content="https://i.loli.net/2020/10/08/ywUDFgG2zNfEYlZ.jpg">
<meta property="article:published_time" content="2020-10-08T15:30:05.000Z">
<meta property="article:modified_time" content="2020-10-20T23:35:17.730Z">
<meta property="article:author" content="HighWay">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/10/08/2X14LC7juO6BPyZ.png"><script src="/js/ui/mode.js"></script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="HighWay"><img width="96" loading="lazy" src="https://blog-1303974131.cos.ap-nanjing.myqcloud.com/picture/key/avatar.jpg" alt="HighWay"></a><div class="site-author-name"><a href="/about/">HighWay</a></div><a class="site-name" href="/about/site.html">小莫神的blog</a><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">65</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">15</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">27</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="留言板"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-clipboard-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/highwayMo" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=360696322" title="网易云音乐" target="_blank" style="color:#C20C0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.zhihu.com/people/highway-60-82" title="知乎" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/177996574?spm_id_from=333.851.b_696e7465726e6174696f6e616c486561646572.10" title="哔哩哔哩" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/girls/" title="喜欢的女孩子" style="color:hotpink"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-women-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8"><span class="toc-text">操作系统启动</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F"><span class="toc-text">什么是操作系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E6%9C%BA%E6%97%B6%E6%89%A7%E8%A1%8C%E4%BA%86%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">开机时执行了什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E5%9B%BE%E8%A7%A3"><span class="toc-text">运行图解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#boot%E6%89%87%E5%8C%BA"><span class="toc-text">boot扇区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bootsect-s"><span class="toc-text">bootsect.s</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#start%E6%A8%A1%E5%9D%97"><span class="toc-text">start模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ok-load-setup%E6%A8%A1%E5%9D%97"><span class="toc-text">ok_load_setup模块</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#setup-s"><span class="toc-text">setup.s</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#start%E6%A8%A1%E5%9D%97-1"><span class="toc-text">start模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#do-move%E6%A8%A1%E5%9D%97"><span class="toc-text">do_move模块</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AF%BB%E5%9D%80%E6%96%B9%E5%BC%8F"><span class="toc-text">保护模式的寻址方式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#head-s"><span class="toc-text">head.s</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#main-c"><span class="toc-text">main.c</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#men-init"><span class="toc-text">men_init</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%B9%B2%E4%BA%86%E4%BB%80%E4%B9%88"><span class="toc-text">操作系统干了什么</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://iljava.gitee.io/2020/10/08/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="HighWay"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="小莫神的blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">操作系统启动<a class="post-edit-link" href="https://github.com/YunYouJun/yunyoujun.github.io/tree/hexo/source/_posts/操作系统/操作系统启动.md" target="_blank" title="编辑" rel="noopener"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-edit-line"></use></svg></a></h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="创建时间：2020-10-08 23:30:05" itemprop="dateCreated datePublished" datetime="2020-10-08T23:30:05+08:00">2020-10-08</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="修改时间：2020-10-21 07:35:17" itemprop="dateModified" datetime="2020-10-21T07:35:17+08:00">2020-10-21</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="本文字数"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="本文字数">3.6k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读时长"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="阅读时长">14m</span></span></span><span class="leancloud_visitors" id="/2020/10/08/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8/" data-flag-title="操作系统启动"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读次数"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span class="leancloud-visitors-count"></span></span></span><div class="post-classify"><span class="post-category"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span> <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">操作系统</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag" href="/tags/Linux/" style="--text-color:#EE9CB3"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">Linux</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><h1 id="操作系统启动"><a href="#操作系统启动" class="headerlink" title="操作系统启动"></a>操作系统启动</h1><h2 id="什么是操作系统"><a href="#什么是操作系统" class="headerlink" title="什么是操作系统"></a>什么是操作系统</h2><p>操作系统是计算机硬件和应用之间的一层<strong>软件</strong> 。</p>
<a id="more"></a>
<table>
<thead>
<tr>
<th>操作系统管理哪些硬件</th>
</tr>
</thead>
<tbody><tr>
<td>CPU管理</td>
</tr>
<tr>
<td>内存管理</td>
</tr>
<tr>
<td>终端管理</td>
</tr>
<tr>
<td>磁盘管理</td>
</tr>
<tr>
<td>文件管理</td>
</tr>
</tbody></table>
<p>计算机工作的原理是<strong>取指执行</strong>，而<strong>指</strong>对应的就是<strong>各种指令</strong>。 </p>
<h2 id="开机时执行了什么？"><a href="#开机时执行了什么？" class="headerlink" title="开机时执行了什么？"></a>开机时执行了什么？</h2><p>计算模型，我们要关注<strong>指针IP</strong>及其<strong>指向的内容</strong>，也就是所谓的<strong>取指执行</strong>。</p>
<ul>
<li>计算机刚开电源时，<strong>IP</strong>=多少呢？</li>
<li>由硬件设计者决定</li>
</ul>
<p>以<strong>x86</strong>架构的<strong>pc</strong>为例</p>
<ol>
<li><p><strong>x86PC</strong>刚开机时<strong>CPU</strong>进入实模式。 </p>
</li>
<li><p>开机时，CS(段地址)=0xFFFF；IP(偏移地址)=0x0000。这是设计时就决定好了</p>
</li>
<li><p>寻址物理地址0xFFFF0(<strong>ROM BIOS映射区</strong>)这是刚开机<strong>唯一</strong>有代码的地方。由<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/bios/91424?fr=aladdin">BIOS</a>读取<strong>bootsect.s</strong>。</p>
<p>  也就是运行图解中1号的<strong>bootsect.s</strong>程序了。</p>
<p>  $$段地址*16+偏移地址=物理地址$$</p>
<p>  $$(CS &lt;&lt; 4) + IP = 物理地址$$</p>
<p>  $$(0xFFFF &lt;&lt; 4) + 0 = (0xFFFF0) + 0 = 0xFFFF0$$</p>
<ol start="4">
<li><p>检查<strong>RAM</strong>，键盘，显示器，软硬磁盘。</p>
</li>
<li><p>将磁盘<strong>0磁道0扇区</strong>(引导扇区512字节)读入0x7c00处。</p>
</li>
<li><p>设置cs=0x07c0，ip=0x0000</p>
</li>
</ol>
</li>
</ol>
<h2 id="运行图解"><a href="#运行图解" class="headerlink" title="运行图解"></a>运行图解</h2><img src="https://i.loli.net/2020/10/08/2X14LC7juO6BPyZ.png" alt="5.png" style="zoom:200%" / loading="lazy">



<h2 id="boot扇区"><a href="#boot扇区" class="headerlink" title="boot扇区"></a>boot扇区</h2><p>该扇区在硬盘的0柱面、0磁头、1扇区，该记录占用512个字节，它用于硬盘启动时将系统控制权转给用户指定的、在分区表中登记了某个<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/192">操作系统</a>分区。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%BC%95%E5%AF%BC%E6%89%87%E5%8C%BA/7444926?fr=aladdin">boot扇区</a>是<strong>启动设备的第一个扇区</strong>。</li>
<li>启动设备信息被设置在<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/CMOS/428167?fr=aladdin">CMOS</a>中</li>
<li>因此，磁盘的<strong>第一个扇区</strong>上存放着开机后执行的第一段我们可以控制的程序。</li>
</ul>
<h2 id="bootsect-s"><a href="#bootsect-s" class="headerlink" title="bootsect.s"></a>bootsect.s</h2><p>bootsect.s是操作系统代码中的操作系统引导程序代码,是通过<strong>第一个扇区</strong>读入地址<strong>0x07C00</strong>的内存里。</p>
<pre class="language-assembly" data-language="assembly"><code class="language-assembly">.globl begtext,begdata,begbss,endtext,enddata,endbss
.text ;文本段
begtext:
.data ;数据段
begdata:
.bss ;未初始化数据段
begbss:
entry start ;关键字entry告诉链接器“程序入口”
#BOOTSEG&#x3D;0×07C0
#INITSEG&#x3D;0×9000
#SETUPLEN&#x3D;4
start:
	mov ax,#BOOTSEG ; 将ds段寄存器置为BOOTSEG&#x3D;0×07C0；
	mov ds,ax 
	mov ax,#INITSEG ;将es段寄存器置为INITSEG&#x3D;0×9000；
	mov es,ax
	mov cx,#100 ; 移动计数值0x100&#x3D;256;
	sub si,si  ; 源地址 ds:si &#x3D; 0×07C0:0×0000
	sub di,di ; 目的地址 es:di &#x3D; 0×9000:0×0000
	rep movw ; 重复执行移动1个字，直到cx &#x3D; 0 移动256个word&#x3D;移动512个byte
	jmpi go,#INITSEG ; 间接跳转。这里cs&#x3D;INITSEG,IP&#x3D;go跳转到INITSEG:go。
go: mov ax,cs ; 将ds、es 和ss 都置成移动后代码所在的段处(cs&#x3D;0×9000)。为call做准备
	mov ds,ax 
	mov es,ax 
	mov ss,ax 
	mov sp,#0xff00
load_setup: &#x2F;&#x2F;载入setup模块
	mov dx,#0x0000 
	mov cx,#0x0002 
	mov bx,#0x0200
	mov ax,#0x0200+SETUPLEN ; ah&#x3D;0x02功能号,al&#x3D;读取几个扇区(SETUPLEN&#x3D;4)
	int 0x13 ; BIOS中断
	jnc ok_load_setup
	mov dx,#0x0000
	mov ax,#0x0000 ;复位
	int 0x13
	j load_setup ;重读</code></pre>

<p>一一进行讲解</p>
<h3 id="start模块"><a href="#start模块" class="headerlink" title="start模块"></a>start模块</h3><p>这个模块通过最开始的图可以清晰的看出是把<strong>bootsect.s</strong>移动到0x90000</p>
<pre class="language-assembly" data-language="assembly"><code class="language-assembly">rep movw</code></pre>

<p>表示移动字，移动的个数是cx=256，也就是512个字节，也就是说这段代码的作用就是将从0x07c00地址处开始的512个字节移动到0x90000处。</p>
<p>在下面这条指令执行之前，对应图中的1号。而当下面的指令开始到<strong>load_setup</strong>模块结束就对应运行图解中的3号了。</p>
<pre class="language-assembly" data-language="assembly"><code class="language-assembly">jmpi go,#INITSEG</code></pre>

<p>这条指令是间接跳转，go-&gt;ip，INITSEG-&gt;CS，前面已经说了INITSEG就是0x9000，go是一个逻辑上的概念，go表示的是<strong>距离start模块的地址偏移</strong>，现在因为已经将0x07c00处的512个字节移动到了0x90000处，所以<strong>逻辑上的start模块</strong>已经到了0x90000，go相较于start的偏移其实也就是相较于INITSEG的偏移，所以也就是顺序执行。</p>
<p>跳转之后就是各种对寄存器，段寄存器初始化，这一切都是为了下面的<strong>int 0x13</strong>中断功能做准备，或者说为了从硬盘上将<strong>setup.s</strong>读入内存</p>
<p><strong>0x13</strong>是<strong>BIOS</strong>读磁盘扇区的<strong>中断</strong>: </p>
<p>下图摘自王爽《汇编语言》</p>
<img src="https://i.loli.net/2020/10/08/gHzMUOjb9Tu1t8l.jpg" alt="4.jpg" style="zoom:150%;" / loading="lazy">

<table>
<thead>
<tr>
<th>ax</th>
<th>ah</th>
<th>al</th>
</tr>
</thead>
<tbody><tr>
<td>0x0200+SETUPLEN</td>
<td>0x02</td>
<td>0x04</td>
</tr>
</tbody></table>
<p><strong>int 0x13</strong>中断功能结束后，<strong>setup</strong>模块就完整地从硬盘中读入到内存了。对应运行图解中的3号</p>
<p>在读入<strong>setup</strong>模块后，来到<strong>ok_load_setup</strong>模块。</p>
<h3 id="ok-load-setup模块"><a href="#ok-load-setup模块" class="headerlink" title="ok_load_setup模块"></a>ok_load_setup模块</h3><pre class="language-assembly" data-language="assembly"><code class="language-assembly">Ok_load_setup: &#x2F;&#x2F;载入setup模块
	mov dl,#0x00 
	mov ax,#0x0800 &#x2F;&#x2F;ah&#x3D;8获得磁盘&#x2F;驱动器参数
	int 0x13 
	mov ch,#0x00 
	mov sectors,cx
	mov ah,#0x03 
	xor bh,bh 
	int 0x10 &#x2F;&#x2F;读光标
	mov cx,#24 
	mov bx,#0x0007
	mov bp,#msg1 
	mov ax,#1301 
	int 0x10 &#x2F;&#x2F;显示字符
	mov ax,#SYSSEG ; SYSSEG&#x3D;0x1000 
	mov es,ax 
	call read_it ; 读入system模块
	jmpi 0,SETUPSEG ; SETUPSEG&#x3D;0×9020</code></pre>

<p>这里又出现了一个<strong>int 0x13</strong>来这里查查对应的功能号吧<a target="_blank" rel="noopener" href="https://blog.csdn.net/jackailson/article/details/84109450">BIOS int 13H中断介绍</a>,</p>
<pre class="language-assembly" data-language="assembly"><code class="language-assembly">mov dl,#0x00 
mov ax,#0x0800 &#x2F;&#x2F;ah&#x3D;8获得磁盘&#x2F;驱动器参数
int 0x13 </code></pre>

<p>下面又有2个<strong>int 0x10</strong>中断功能，这个又是什么呢？<a target="_blank" rel="noopener" href="https://www.cnblogs.com/magic-cube/archive/2011/10/19/2217676.html">INT 10H功能</a><a target="_blank" rel="noopener" href="https://www.cnblogs.com/magic-cube/archive/2011/10/19/2217676.html">INT 10H功能</a></p>
<pre class="language-assembly" data-language="assembly"><code class="language-assembly">mov ch,#0x00 
mov sectors,cx
mov ah,#0x03 
xor bh,bh 
int 0x10 ; 读光标
mov cx,#24 
mov bx,#0x0007
mov bp,#msg1 
mov ax,#1301 
int 0x10 ;显示字符</code></pre>

<img src="https://i.loli.net/2020/10/08/QlkMGhBSKTizjoq.jpg" alt="6.jpg" style="zoom:200%;" / loading="lazy">

<p>这里是<strong>bootsect.s</strong>中的数据</p>
<pre class="language-assembly" data-language="assembly"><code class="language-assembly">;bootsect.s中的数据
sectors: .word 0 ; 磁道扇区数
msg1:.byte 13,10
.ascii “Loading system...”
.byte 13,10,13,10</code></pre>

<p>第一个<strong>int 10</strong>就是在读光标的位置，第二个<strong>int 10</strong>是将msg1=“Loading system…”输出到光标所在处。下面的call是读入<strong>system</strong>模块。读入<strong>system</strong>模块后</p>
<pre class="language-assembly" data-language="assembly"><code class="language-assembly">jmpi 0,SETUPSEG ; SETUPSEG&#x3D;0×9020</code></pre>

<p>指针跳回0x90200也就是<strong>setup.s</strong>的起始位置，这里开始<strong>bootsect.s</strong>的任务就结束了，下面的事情就交给<strong>setup.s</strong>了。</p>
<h2 id="setup-s"><a href="#setup-s" class="headerlink" title="setup.s"></a>setup.s</h2><p><strong>setup.s</strong>是完成系统启动前设置的，它将硬件的参数存放在0x90000处，然后将system部分移动到从地址0开始的位置,对应的就是运行图解的5号了；临时建立gdt、idt表，并且从实模式进入到了保护模式（16位到32位）。</p>
<pre class="language-assembly" data-language="assembly"><code class="language-assembly">start: 
	mov ax,#INITSEG 
	mov ds,ax 
	mov ah,#0x03
	xor bh,bh 
	int 0x10 ; 取光标位置dx mov [0],dx
	mov ah,#0x88 
	int 0x15 
	mov [2],ax ...
	cli &#x2F;&#x2F;&#x2F;不允许中断
	mov ax,#0x0000 cld
do_move: 
	mov es,ax 
	add ax,#0x1000
	cmp ax,#0x9000 
	jz end_move
	mov ds,ax 
	sub di,di
	sub si,si
	mov cx,#0x8000
	rep ; 将system模块移到0地址
	movsw
	jmp do_move</code></pre>

<h3 id="start模块-1"><a href="#start模块-1" class="headerlink" title="start模块"></a>start模块</h3><p>操作系统是管理各种硬件的，要管理这些硬件必要首先要知道这些硬件到底是什么东西，是什么型号的，应该用怎样的数据结构来管理。对应<strong>运行图解</strong>的4号。</p>
<p>上面这段代码的作用就是<strong>获取硬件参数</strong>，然后将这些信息放在0x90000开始的地方；最后将操作系统从0x90000开始处移到地址0开始处，这就是为什么一开始要移动<strong>bootsect.s</strong>的原因，因为操作系统可能会覆盖0x07c00这个地址。</p>
<table>
<thead>
<tr>
<th>地址</th>
<th>长度</th>
<th>名称</th>
</tr>
</thead>
<tbody><tr>
<td>0x90000</td>
<td>2</td>
<td>光标位置</td>
</tr>
<tr>
<td>0x90002</td>
<td>2</td>
<td>扩展内存数</td>
</tr>
<tr>
<td>0x9000C</td>
<td>2</td>
<td>显卡参数</td>
</tr>
<tr>
<td>0x901FC</td>
<td>2</td>
<td>根设备号</td>
</tr>
</tbody></table>
<h3 id="do-move模块"><a href="#do-move模块" class="headerlink" title="do_move模块"></a>do_move模块</h3><p>将<strong>system</strong>模块移动到0x00000后，就是<strong>运行图解</strong>的5号了。需要特别注意的地方是最后的几行汇编</p>
<pre class="language-assembly" data-language="assembly"><code class="language-assembly">end_move: 
	mov ax,#SETUPSEG 
	mov ds,ax
	lidt idt_48 
	lgdt gdt_48 ;设置保护模式下的中断和寻址 进入保护模式的命令...</code></pre>

<p>进入保护模式代码</p>
<pre class="language-assembly" data-language="assembly"><code class="language-assembly">;8042是键盘控制器，其输出端口P2用来控制A20地址线
call empty_8042 
mov al,#0xD1 
out #0x64,al
call empty_8042 
mov al,#0xDF 
out #0x60,al
;选通A20地址线 
call empty_8042
;初始化8259(中断控制) 一段非常机械化的程序
mov ax,#0x0001 
mov cr0,ax
jmpi 0,8</code></pre>

<p>不得不说一下<strong>cr0</strong>寄存器。</p>
<img src="https://i.loli.net/2020/10/08/xsHfgd8cnYv3E5Z.jpg" alt="7.jpg" style="zoom:150%;" / loading="lazy">

<pre class="language-assembly" data-language="assembly"><code class="language-assembly">mov ax,#0x0001 
mov cr0,ax</code></pre>

<p>可以看到<strong>cr0</strong>是一个32位寄存器，<strong>ax</strong>为1，将<strong>ax</strong>赋值给<strong>cr0</strong>，也就是第0位/PE位为1，启动保护模式/32位模式。<strong>寻址模式</strong>发生改变。</p>
<pre class="language-assembly" data-language="assembly"><code class="language-assembly">jmpi 0,8 </code></pre>

<p>前面提到过jmpi这条指令，意思是将前操作数赋给ip，后操作数赋给cs，然后跳转到cs、ip所表示的位置执行。</p>
<p>但是这里能不能这样解释呢？如果是那么就是跳到0x00080处执行，对吗？</p>
<p>刚刚执行完<strong>setup.s</strong>后面应该是继续执行<strong>system</strong>模块才是，<strong>system</strong>模块都被移动到0地址处了，也就是说现在<strong>system</strong>模块最开始位置是0地址处，即应该执行0x00000处代码而不是0x00080处，如果直接执行0x00080，结果肯定是死机。</p>
<p>所以说现在<strong>jmpi</strong>这条指令肯定不能这么解释了。这条指令应该被解释成查<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/GDT/20314752?fr=aladdin">GDT</a>表。</p>
<h4 id="保护模式的寻址方式"><a href="#保护模式的寻址方式" class="headerlink" title="保护模式的寻址方式"></a>保护模式的寻址方式</h4><p>上面也提到了进入保护模式后，<strong>寻址模式</strong>发生了改变，所以下面讲一讲<strong>保护模式</strong>中该如何寻址。<strong>保护模式</strong>的另一种说法就是32位模式，换句话说<strong>保护模式</strong>的寻址方式是为了能够对32位的地址进行寻址。最多寻址4G，这里我总会想到之前逆向学习的时候听到的一句话，<strong>32位就是4GB</strong>。</p>
<pre class="language-assembly" data-language="assembly"><code class="language-assembly">lidt idt_48  ! load idt with 0,0 
lgdt gdt_48 ! load gdt with whatever appropriate
idt_48:
	.word 0 
	.word 0,0 ; 保护模式中断函数表
gdt_48:
	.word 0x800 
	.word 512+gdt,0x9 
gdt: 
	.word 0,0,0,0 
    .word 0x07FF, 0x0000, 0x9A00, 0x00C0
    .word 0x07FF, 0x0000, 0x9200, 0x00C0</code></pre>

<p>以前CS里面放的是地址，现在CS里面放的是表的下标（称为”选择子”），这个表就是gdt（全局描述表）表，那么这个表是哪里来的呢？在<strong>setup.s</strong>的时候建立的。</p>
<p>把目光放到<strong>GDT</strong>表，每一行都是一个表项，每一个表项由4个<strong>word</strong>组成。但是在保护模式下<strong>jmpi 0,8</strong>中的8指的是<strong>GDT</strong>表第8个<strong>byte</strong>，或者说是第4个<strong>word</strong>。也就是第二行的表项。</p>
<p><img src="https://i.loli.net/2020/10/08/ywUDFgG2zNfEYlZ.jpg" alt="系统描述符.jpg" loading="lazy"></p>
<table>
<thead>
<tr>
<th>63-48(16-31)</th>
<th>32-47(0-15)</th>
</tr>
</thead>
<tbody><tr>
<td>0x00C0</td>
<td>0x9A00</td>
</tr>
<tr>
<td>0x0000</td>
<td>0x07FF</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>BASE</strong>指的是包含段的首字节的线性地址。</p>
<p>​                                                                   ————《深入理解Linux内核》P43</p>
</blockquote>
<p>我们将<strong>BASE</strong>对应的几个部分拿出来看看</p>
<table>
<thead>
<tr>
<th>BASE(0-15)</th>
<th>BASE(16-23)</th>
<th>BASE(24-31)</th>
</tr>
</thead>
<tbody><tr>
<td>0000</td>
<td>00</td>
<td>00</td>
</tr>
</tbody></table>
<p>刚好是一个32位的地址，众所周知32位的地址就是32位的，到这里应该就豁然开朗了。因为在16位中无法直接寻址32位地址，所以通过<strong>GDT</strong>表这样的方式来拼接出一个32位地址来寻址。</p>
<p>简单来说，<strong>jmpi指令</strong>应该被解释成查<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/GDT/20314752?fr=aladdin">GDT</a>表，而<strong>保护模式</strong>的<strong>寻址方式</strong>就是通过<strong>GDT</strong>表来寻址。</p>
<p>将地址指向0x00000意味着<strong>setup.s</strong>的任务也完成了。接下来的事情就交给位于0x00000的代码了。</p>
<h2 id="head-s"><a href="#head-s" class="headerlink" title="head.s"></a>head.s</h2><p><strong>head.s</strong>就是位于0x00000的代码了，同时也是<strong>system</strong>模块的开始。</p>
 <pre class="language-assembly" data-language="assembly"><code class="language-assembly">stratup_32: 
	movl $0x10,%eax 
	mov %ax,%ds 
	mov %ax,%es
	mov %as,%fs 
	mov %as,%gs ; 指向gdt的0x10项(数据段)
	lss _stack_start,%esp ; 设置栈(系统栈)
	call setup_idt  ; 再次初始化idt
	call setup_gdt ; 再次初始化gdt
	xorl %eax,%eax
1:incl %eax
	movl %eax,0x000000 
	cmpl %eax,0x100000
	je 1b ;0地址处和1M地址处相同(A20没开启)，就死循环
	jmp after_page_tables ;页表，什么东东?
setup_idt: 
	lea ignore_int,%edx 
	movl $0x00080000,%eax 
	movw %dx,%ax
	lea _idt,%edi 
	movl %eax,(%edi)</code></pre>
<p>在<strong>head.s</strong>里面会重新设置<strong>idt</strong>表、<strong>gdt</strong>表(call setup_idt、call_setup_gdt)，前面setup里面设置的gdt和idt都是临时的；这里会重新设置。</p>
<p>还会开启A20地址线(je 1b)，开启A20地址线之后寻址范围就是<strong>4G</strong>而不再是<strong>1M</strong>。<br>IDT表是中断函数表，从此<strong>int n</strong> 不再是<strong>DOS中断</strong>了，而是在<strong>IDT表</strong>中找到中断函数的地址执行，<br>注意是：硬件查表，不是软件，idt、gdt表的查表方法都是硬件规定好的，目的就是为了加快速度。<br>注意，在<strong>head.s</strong>使用的汇编又和前面bootsect、setup里面使用的汇编不一样，在head.s里面使用的是产生32位代码汇编，而bootsect、setup里面使用的是产生16位代码的汇编。另外在操作系统的.c文件里面还使用了一种汇编，叫做“内嵌汇编”。</p>
<pre class="language-assembly" data-language="assembly"><code class="language-assembly">after_page_tables:
    pushl $0 
    pushl $0 
    pushl $0 
    pushl $L6
    pushl $_main 
    jmp setup_paging
L6: jmp L6
setup_paging: ; 设置页表 ret</code></pre>
<p>前面开启20号地址线之后就<strong>jmp</strong>到<strong>after_page_tables</strong>这个标号，在<strong>setup_paging</strong>执行完后，<strong>ret</strong>到哪里呢？<br>到main()函数。在<strong>after_page_tables</strong>里面将main函数三个参数、L6、main函数的入口地址都压入栈中，在<strong>setup_paging</strong>的<strong>ret</strong>直接跳<strong>_main</strong>，如果<strong>main</strong>函数再返回的话就跳到L6处，从上面可以看到</p>
<pre class="language-assembly" data-language="assembly"><code class="language-assembly">L6: jmp L6</code></pre>

<p>这是一个死循环，也就是说如果操作系统执行了这条指令，那么就会死机。<strong>main</strong>函数是不会返回的。<br>其实从<strong>head.s</strong>到<strong>main.c</strong>的过程和c语言里面的函数调用是一样的，首先将函数执行完之后的下一个地址和函数参数压入栈中，然后通过<strong>jmp</strong>命令跳到子函数的执行处，执行完了之后再利用<strong>ret</strong>跳到程序原来执行的地方。</p>
<h2 id="main-c"><a href="#main-c" class="headerlink" title="main.c"></a>main.c</h2><p>main函数完成了各种硬件数据结构的初始化。永远不会退出，如果退出就死机了。</p>
<pre class="language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">mem_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">trap_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">blk_dev_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">chr_dev_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">tty_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">time_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">sched_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">buffer_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">hd_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">floppy_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">sti</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">move_to_user_mode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>   <span class="token comment">// 这行永远不会退出</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>前面说了<strong>main</strong>函数由三个参数，为什么这里没写出来呢？</p>
<p><strong>main</strong>函数的三个参数为envp、argc、argv，但是此处并没有使用，所以此处的main只保留传统main形式。</p>
<p>从main函数内容可以看到，<strong>main</strong>函数的工作就是<strong>init</strong>：内存、中断、设备、时钟、CPU等内容的初始化。</p>
<h3 id="men-init"><a href="#men-init" class="headerlink" title="men_init"></a>men_init</h3><p>这里介绍内存的初始化函数</p>
<pre class="language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">mem_init</span><span class="token punctuation">(</span><span class="token keyword">long</span> start_mem<span class="token punctuation">,</span><span class="token keyword">long</span> end_mem<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>PAGING_PAGES<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    mem_map<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> USED<span class="token punctuation">;</span>
    i <span class="token operator">=</span> <span class="token function">MAP_NR</span><span class="token punctuation">(</span>start_mem<span class="token punctuation">)</span><span class="token punctuation">;</span>
    end_mem <span class="token operator">-=</span> start_mem<span class="token punctuation">;</span>
    end_mem <span class="token operator">>>=</span> <span class="token number">12</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>end_mem <span class="token operator">--</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
    mem_map<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span></code></pre>

<p>其实这个函数就是初始化<strong>mem_map</strong>这个数组，start_men、end_men这些参数都是在<strong>setup</strong>的时候就获取到的。可以回头翻看<strong>setup.s</strong>的<strong>start</strong>模块存储了哪些硬件参数。</p>
<h2 id="操作系统干了什么"><a href="#操作系统干了什么" class="headerlink" title="操作系统干了什么"></a>操作系统干了什么</h2><p>其实<strong>bootsect.s</strong> 、<strong>setup.s</strong> 、<strong>heads.s</strong> 、<strong>main.c</strong>这些文件就做了两件事：</p>
<ol>
<li>读入操作系统并移动到合适的位置.</li>
<li>初始化（为每一个硬件建立数据结构、并初始化）</li>
</ol>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">施主,贫僧化缘来了！</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://blog-1303974131.cos.ap-nanjing.myqcloud.com/picture/zfb.jpg"><img loading="lazy" src="https://blog-1303974131.cos.ap-nanjing.myqcloud.com/picture/zfb.jpg" alt="支付宝" title="支付宝"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://blog-1303974131.cos.ap-nanjing.myqcloud.com/picture/vx.jpg"><img loading="lazy" src="https://blog-1303974131.cos.ap-nanjing.myqcloud.com/picture/vx.jpg" alt="微信支付" title="微信支付"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>HighWay</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://iljava.gitee.io/2020/10/08/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8/" title="操作系统启动">https://iljava.gitee.io/2020/10/08/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> 许可协议。</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2020/10/09/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/DNS%E9%83%A8%E7%BD%B2%E4%B8%8E%E5%AE%89%E5%85%A8/" rel="prev" title="DNS部署与安全"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">DNS部署与安全</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2020/10/07/bilibili/xctf%E6%96%B0%E6%89%8B%E5%8C%BAre%E8%AF%A6%E8%A7%A3/" rel="next" title="xctf新手区re详解"><span class="post-nav-text">xctf新手区re详解</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div id="comment"><div class="comment-tooltip text-center"><span>尝试使用 Disqus 评论系统。</span><br><span>您可以点击下方按钮切换对应评论系统。</span><br><div class="toggle-comment-system" style="margin: 1rem auto"><a class="toggle-comment-btn hty-button hty-button--raised text-uppercase" data-target="#valine-container" onclick="showComment(this.dataset.target)">valine</a><style>#disqus_thread {
  display: none;
}</style><a class="toggle-comment-btn hty-button hty-button--raised text-uppercase" data-target="#disqus_thread" onclick="showComment(this.dataset.target)">disqusjs</a><script>function hideAllComment() {
  //- hide all
  document.querySelectorAll('.toggle-comment-btn').forEach((btn) => {
    const container = document.querySelector(btn.dataset.target);
    if (container) {
      container.style.display = "none";
    }
  });
}
function showComment(target) {
  hideAllComment();
  //- show target
  const targetContainer = document.querySelector(target);
  if (targetContainer) {
    targetContainer.style.display = "block";
  }
}
</script></div></div><div id="disqus_thread"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/disqusjs@latest/dist/disqusjs.css"><script src="https://cdn.jsdelivr.net/npm/disqusjs@latest/dist/disqus.js"></script><script>const dsqjs = new DisqusJS({
  shortname: 'yunyoujun',
  apikey: 'ouoGQCaamOKdJgyZU5DKcpFnRIg3SNzvk0nwygPtlcTRJuE68c8igvrZGW4wAJoN',
  url: 'https://iljava.gitee.io/2020/10/08/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8/'
})
</script><div id="valine-container"></div><script src="https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><script>function initValine() {
  const valineConfig = {"enable":true,"appId":"xlwSW83iKlOEww90sT4bxHEb-gzGzoHsz","appKey":"hfmNtwBPpnMtVLvhG6TQltLT","placeholder":"大佬求指教&nbsp_(:з」∠)_","avatar":null,"pageSize":10,"visitor":true,"highlight":true,"recordIP":true,"enableQQ":true,"requiredFields":["nick","mail"],"emojiCDN":"//i0.hdslb.com/bfs/emote/","emojiMaps":{"tv_doge":"6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png","tv_亲亲":"a8111ad55953ef5e3be3327ef94eb4a39d535d06.png","tv_偷笑":"bb690d4107620f1c15cff29509db529a73aee261.png","tv_再见":"180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png","tv_冷漠":"b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png","tv_发怒":"34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png","tv_发财":"34db290afd2963723c6eb3c4560667db7253a21a.png","tv_可爱":"9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png","tv_吐血":"09dd16a7aa59b77baa1155d47484409624470c77.png","tv_呆":"fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png","tv_呕吐":"9f996894a39e282ccf5e66856af49483f81870f3.png","tv_困":"241ee304e44c0af029adceb294399391e4737ef2.png","tv_坏笑":"1f0b87f731a671079842116e0991c91c2c88645a.png","tv_大佬":"093c1e2c490161aca397afc45573c877cdead616.png","tv_大哭":"23269aeb35f99daee28dda129676f6e9ea87934f.png","tv_委屈":"d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png","tv_害羞":"a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png","tv_尴尬":"7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png","tv_微笑":"70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png","tv_思考":"90cf159733e558137ed20aa04d09964436f618a1.png","tv_惊吓":"0d15c7e2ee58e935adc6a7193ee042388adc22af.png","tv_打脸":"56ab10b624063e966bfcb76ea5dc4794d87dfd47.png","tv_抓狂":"fe31c08edad661d63762b04e17b8d5ae3c71a757.png","tv_抠鼻":"c666f55e88d471e51bbd9fab9bb308110824a6eb.png","tv_斜眼笑":"911f987aa8bc1bee12d52aafe62bc41ef4474e6c.png","tv_无奈":"ea8ed89ee9878f2fece2dda0ea8a5dbfe21b5751.png","tv_晕":"5443c22b4d07fb1907ccc610c8e6db254f2461b7.png","tv_流汗":"cead1c351ab8d79e9f369605beb90148db0fbed3.png","tv_流泪":"7e71cde7858f0cd50d74b0264aa26db612a8a167.png","tv_流鼻血":"c32d39db2737f89b904ca32700d140a9241b0767.png","tv_点赞":"f85c354995bd99e28fc76c869bfe42ba6438eff4.png","tv_生气":"26702dcafdab5e8225b43ffd23c94ac1ff932654.png","tv_生病":"8b0ec90e6b86771092a498c54f09fc94621c1900.png","tv_疑问":"0793d949b18d7be716078349c202c15ff166f314.png","tv_白眼":"c1d59f439e379ee50eef488bcb5e5378e5044ea4.png","tv_皱眉":"72ccad6679fea0d14cce648b4d818e09b8ffea2d.png","tv_目瞪口呆":"0b8cb81a68de5d5365212c99375e7ace3e7891b7.png","tv_睡着":"8b196675b53af58264f383c50ad0945048290b33.png","tv_笑哭":"1abc628f6d4f4caf9d0e7800878f4697abbc8273.png","tv_腼腆":"89712c0d4af73e67f89e35cbc518420380a7f6f4.png","tv_色":"61822c7e9aae5da76475e7892534545336b23a6f.png","tv_调侃":"4bc022533ef31544ca0d72c12c808cf4a1cce3e3.png","tv_调皮":"b9c41de8e82dd7a8515ae5e3cb63e898bf245186.png","tv_鄙视":"6e72339f346a692a495b123174b49e4e8e781303.png","tv_闭嘴":"c9e990da7f6e93975e25fd8b70e2e290aa4086ef.png","tv_难过":"87f46748d3f142ebc6586ff58860d0e2fc8263ba.png","tv_馋":"fc7e829b845c43c623c8b490ee3602b7f0e76a31.png","tv_鬼脸":"0ffbbddf8a94d124ca2f54b360bbc04feb6bbfea.png","tv_黑人问号":"45821a01f51bc867da9edbaa2e070410819a95b2.png","tv_鼓掌":"1d21793f96ef4e6f48b23e53e3b9e42da833a0f6.png"},"el":"#valine-container","lang":"zh-cn"}
  valineConfig.path = window.location.pathname
  new Valine(valineConfig)
}
setTimeout(initValine, 1000)</script></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">桂ICP备2020008065号</a></div><div class="copyright"><span>&copy; 2020 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> HighWay</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v5.2.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.2.0</span></div><div class="live_time"><span>本博客已萌萌哒地运行</span><span id="display_live_time"></span><span class="moe-text">(●'◡'●)</span><script>function blog_live_time() {
  window.setTimeout(blog_live_time, 1000);
  const start = new Date('2020-10-05T21:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " 天 " + passHour + " 小时 " + passMinute + " 分 " + passSecond + " 秒";
}
blog_live_time();
</script></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a></div><script defer src="/js/utils.js"></script><script defer src="/js/hexo-theme-yun.js"></script></body></html>